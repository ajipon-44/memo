# Next.js チュートリアル

## Chapter 3 - Optimizing Fonts and Images -

### フォントの最適化

#### フォントの種類

フォールバックフォント ... HTML や OS に標準で備わっているフォント（h1 や bold など）。別名システムフォント。
カスタムフォント ... CSS などで装飾されたフォント。サーバや外部リソースから取得する。

#### ブラウザの挙動

1. ページを読み込み、システムフォントで出力する。
2. CSS やフォントファイルをロードする（ここでファイル取得や読み込みのための時間がかかってしまう）。
3. 装飾されたページが表示される。

#### レイアウトシフト

システムフォントからカスタムフォントに切り替わった時に、文字の大きさや文字同士の間隔の差異によって起こるページのずれ

#### CLS（累積レイアウトシフト）

Google のサイト評価の指標の 1 つ。これが大きいと、ページの表示に時間がかかると判定される。

#### next/font

ビルド時にフォントに関するロードを行う
よって、ユーザが使う時に、オーバーヘッドが生じない

### 画像の最適化

#### 画像の最適化をすべき理由

画像の読み込みには一定の時間がかかるので、最適化の有無によって SEO や UX に大きく影響する

#### 従来の画像の最適化

以下の項目は従来は手動で最適化を行なっていた。

1. **レスポンシブ画像の確保**
   画像が異なる画面サイズに対応できるようにする。
2. **異なるデバイス用の画像サイズ指定**
   モバイルデバイスとデスクトップで異なるサイズの画像を使い分ける。
3. **レイアウトシフトの防止**
   画像が読み込まれる際に、ページが動かないようにする。
4. **遅延読み込み（Lazy loading）の実装**
   ユーザーが実際に画像を見るまで、画像を読み込まないようにする。

#### Image コンポーネント

HTML の img タグの拡張版で手動で行っていた項目を自動で行う

1. **最新フォーマットでの提供**

   WebP や AVIF といった、ブラウザがサポートしている最新の画像フォーマットを使用して、画像サイズを圧縮する。
   これにより、読み込み速度がさらに向上する。
   ブラウザがこれらのフォーマットをサポートしていない場合は、他の形式の画像を使う。

2. **異なるデバイス用の画像サイズ指定**
   デバイスを検知して、自動で画像をリサイズする。

3. **レイアウトシフトの防止**
   （元の画像サイズや CSS などから算出したサイズをもとに）画像のサイズ表示領域をあらかじめ確保しておくことによって、画像が表示されたときに、ページのレイアウトが崩れることを防ぐ。
   よって、`width`と`height`の属性を指定することが必須。

4. **遅延読み込み（Lazy loading）の実装**
   デフォルトで遅延読み込みを行うので、パフォーマンスが向上する。
